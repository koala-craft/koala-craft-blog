# Obsidian Log 開発ガイド

## ディレクトリ設計（ハイブリッド feature-based）

ルート定義は `src/routes/` に維持しつつ、ロジック・コンポーネントを feature 単位で分離する。

### 方針

- **routes/**: TanStack Router のファイルベースルーティング。URL とページの対応のみ定義し、実装は feature から import
- **features/**: 機能ごとに API・型・コンポーネントを集約。各 feature は自己完結
- **shared/**: 複数 feature で使うライブラリ・コンポーネント

### 各 feature の責務

| feature | 内容 |
|---------|------|
| articles | 記事の取得（getArticles, getArticle）、Article 型 |
| scraps | スクラップの取得（getScraps, getScrap）、Scrap 型 |
| tasks | タスクの取得・集計、Supabase 連携 |
| admin | 管理画面用のロジック（認証チェック等） |

### 参照ルール

- feature 内のモジュールは feature 内で完結させる
- 他 feature を参照する場合は、その feature の public API（api.ts, types.ts）のみ import
- shared は feature から参照してよい。shared から feature を参照しない

### 現在の構成

```
src/
├── features/
│   ├── articles/     # api.ts, types.ts（GitHub またはローカル）
│   ├── scraps/       # api.ts, types.ts（GitHub またはローカル）
│   ├── tasks/        # api.ts, adminApi.ts
│   └── admin/        # auth, siteConfig, useAuth 等
├── shared/
│   ├── lib/          # supabase, slug, github, contentSource
│   └── components/   # DefaultCatchBoundary, NotFound
└── routes/           # ルート定義
```

### コンテンツ取得元

- **site_config.github_repo_url** が設定されていれば GitHub API から取得
- 未設定ならローカル `content/` を参照
- **GITHUB_TOKEN**（任意）: レート制限緩和（60→5000 回/時）
